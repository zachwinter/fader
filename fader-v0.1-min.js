/*
 * 
 *	fader.js v0.1 (c) 2014
 *	Expandable jQuery Content Fader
 * 
 *	@author:  Zach Winter (contact@zachwinter.com)
 *	@license: MIT (http://www.opensource.org/licenses/mit-license.php)
 *
 */

; (function(a){a.fn.fader=function(d){var m=this;var s=a.extend({fadeSpeed:1500,swapDelay:7500,autoSwap:true,keyboard:true,baseIndex:0,bullets:false,fixedAspect:false,prevButton:false,nextButton:false,breakout:false,disableOnResize:true,changeStart:function(i){},changeEnd:function(i){}},d);var f=1,p=m.find("> *"),g=m.find("> *:first-child"),c=false,j;var u=false;if(typeof Modernizr!="undefined"&&typeof Modernizr.csstransitions!="undefined"){u=Modernizr.csstransitions;}else{var v=document.createElement("div").style,h=[v.transition,v.WebkitTransition,v.MozTransition];for(var r=0;r<h.length;r++){if(h[r]!=undefined){u=true;break;}}}var k=function(){s.bullets.find("a").on("click",function(w){var i=a(this);if(!i.hasClass("active")&&c==false){s.bullets.find("a").removeClass("active");i.addClass("active");l(parseInt(i.attr("data-target")));}w.preventDefault();});};var n=function(){var i=a(document);i.on("keydown",function(w){if(w.keyCode==37&&c==false){q(false);}if(w.keyCode==39&&c==false){q(true);}});};var o=function(){if(s.prevButton!=false){s.prevButton.on("click",function(i){if(c!=true){q(false);}i.preventDefault();});}if(s.nextButton!=false){s.nextButton.on("click",function(i){if(c!=true){q(true);}i.preventDefault();});}};var q=function(i){if(s.bullets!=false){s.bullets.find("a").removeClass("active");}if(i==true){if(f==p.length){if(s.bullets!=false){s.bullets.find('[data-target="1"]').addClass("active");}l(1);}else{if(s.bullets!=false){s.bullets.find('[data-target="'+(f+1)+'"]').addClass("active");}l(f+1);}}else{if(f==1){if(s.bullets!=false){s.bullets.find('[data-target="'+p.length+'"]').addClass("active");}l(p.length);}else{if(s.bullets!=false){s.bullets.find('[data-target="'+(f-1)+'"]').addClass("active");}l(f-1);}}};var l=function(w){var x=this,y=a('[data-slide="'+f+'"]'),i=a('[data-slide="'+w+'"]');c=true;m.trigger("slidechangestart");s.changeStart({event:"slidechangestart",container:m,currentSlide:f,upcomingSlide:w,totalSlides:p.length,settings:s});if(s.fixedAspect==false){m.css("height",m.height());}y.css({position:"absolute",zIndex:s.baseIndex});x.cssAnimation=function(){i.one("transitionend webkitTransitionEnd",function(){x.finishUp();y.css({opacity:0,webkitTransition:"none",mozTransition:"none",transition:"none",zIndex:s.baseIndex});}).css({zIndex:s.baseIndex+1,opacity:1,webkitTransition:"opacity "+(s.fadeSpeed/1000)+"s ease",mozTransition:"opacity "+(s.fadeSpeed/1000)+"s ease",transition:"opacity "+(s.fadeSpeed/1000)+"s ease"});};x.jQueryAnimation=function(){i.css({zIndex:s.baseIndex+1}).fadeIn(s.fadeSpeed,function(){x.finishUp();y.hide();});};x.finishUp=function(){i.css("position","relative");if(s.fixedAspect==false){m.css("height","auto");}f=w;c=false;m.trigger("slidechangeend");s.changeEnd({event:"slidechangeend",container:m,currentSlide:f,totalSlides:p.length,settings:s});if(s.autoSwap==true){e();}};if(u==true){x.cssAnimation();}else{x.jQueryAnimation();}};var e=function(){clearTimeout(j);j=setTimeout(function(){if(c==false){q(true);}},s.swapDelay);};var t=function(){var w=this,i=a(window),x=false;w.trigger=function(){c=false;if(s.autoSwap==true){e();}};i.on("resize",function(){if(x!=false){clearTimeout(x);}c=true;x=setTimeout(w.trigger,300);});};if(m.length){var b=m.css("position");if(b!="absolute"||b!="relative"||b!="fixed"){m.css("position","relative");}m.css("overflow","hidden");if(s.fixedAspect!=false){m.css({height:0,paddingBottom:s.fixedAspect+"%"});}if(u==true){p.css({display:"block",position:"absolute",top:0,opacity:0,width:"100%",height:"100%"});p.eq(0).css({opacity:1,zIndex:s.baseIndex+1,position:"relative"});}else{p.css({display:"none",position:"absolute",top:0,width:"100%",height:"100%"});p.eq(0).css({position:"relative",display:"block"});}p.each(function(){a(this).attr("data-slide",(a(this).index()+1));});if(s.breakout!=false){s.breakout.find("> *").each(function(){a(this).attr("data-breakout",(a(this).index()+1));});}if(s.bullets!=false){for(var r=0;r<p.length;r++){s.bullets.append('<li><a href="#" data-target="'+(r+1)+'">&nbsp;</a></li>');}s.bullets.find("li:first-child a").addClass("active");k();}if(s.keyboard==true){n();}if(s.prevButton!=false||s.nextButton!=false){o();}if(s.autoSwap==true){e();}if(s.disableOnResize==true){t();}}};})(jQuery);