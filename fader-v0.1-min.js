/*
 * 
 *	fader.js v0.1 (c) 2014
 *	Expandable jQuery Content Fader
 * 
 *	@author:  Zach Winter (contact@zachwinter.com)
 *	@license: MIT (http://www.opensource.org/licenses/mit-license.php)
 *
 */

; (function(e){e.fn.fader=function(t){var n=this;var r=e.extend({fadeSpeed:1500,swapDelay:7500,autoSwap:true,keyboard:true,baseIndex:0,bullets:false,fixedAspect:false,prevButton:false,nextButton:false,breakout:false,disableOnResize:true,changeStart:function(e){},changeEnd:function(e){}},t);var i=1,s=n.find("> *"),o=n.find("> *:first-child"),u=false,a;var f=false;if(typeof Modernizr!="undefined"&&typeof Modernizr.csstransitions!="undefined"){f=Modernizr.csstransitions}else{var l=document.createElement("div").style,c=[l.transition,l.WebkitTransition,l.MozTransition];for(var h=0;h<c.length;h++){if(c[h]!=undefined){f=true;break}}}var p=function(){r.bullets.find("a").on("click",function(t){var n=e(this);if(!n.hasClass("active")&&u==false){r.bullets.find("a").removeClass("active");n.addClass("active");g(parseInt(n.attr("data-target")))}t.preventDefault()})};var d=function(){var t=e(document);t.on("keydown",function(e){if(e.keyCode==37&&u==false){m(false)}if(e.keyCode==39&&u==false){m(true)}})};var v=function(){if(r.prevButton!=false){r.prevButton.on("click",function(e){if(u!=true){m(false)}e.preventDefault()})}if(r.nextButton!=false){r.nextButton.on("click",function(e){if(u!=true){m(true)}e.preventDefault()})}};var m=function(e){if(r.bullets!=false){r.bullets.find("a").removeClass("active")}if(e==true){if(i==s.length){if(r.bullets!=false){r.bullets.find('[data-target="1"]').addClass("active")}g(1)}else{if(r.bullets!=false){r.bullets.find('[data-target="'+(i+1)+'"]').addClass("active")}g(i+1)}}else{if(i==1){if(r.bullets!=false){r.bullets.find('[data-target="'+s.length+'"]').addClass("active")}g(s.length)}else{if(r.bullets!=false){r.bullets.find('[data-target="'+(i-1)+'"]').addClass("active")}g(i-1)}}};var g=function(t){var o=this,a=e('[data-slide="'+i+'"]'),l=e('[data-slide="'+t+'"]');u=true;n.trigger("slidechangestart");r.changeStart({event:"slidechangestart",container:n,currentSlide:i,upcomingSlide:t,totalSlides:s.length,settings:r});if(r.fixedAspect==false){n.css("height",n.height())}a.css({position:"absolute",zIndex:r.baseIndex});o.cssAnimation=function(){l.one("transitionend webkitTransitionEnd",function(){o.finishUp();a.css({opacity:0,webkitTransition:"none",mozTransition:"none",transition:"none",zIndex:r.baseIndex})}).css({zIndex:r.baseIndex+1,opacity:1,webkitTransition:"opacity "+r.fadeSpeed/1e3+"s ease",mozTransition:"opacity "+r.fadeSpeed/1e3+"s ease",transition:"opacity "+r.fadeSpeed/1e3+"s ease"})};o.jQueryAnimation=function(){l.css({zIndex:r.baseIndex+1}).fadeIn(r.fadeSpeed,function(){o.finishUp();a.hide()})};o.finishUp=function(){l.css("position","relative");if(r.fixedAspect==false){n.css("height","auto")}i=t;u=false;n.trigger("slidechangeend");r.changeEnd({event:"slidechangeend",container:n,currentSlide:i,totalSlides:s.length,settings:r});if(r.autoSwap==true){y()}};if(f==true){o.cssAnimation()}else{o.jQueryAnimation()}};var y=function(){clearTimeout(a);a=setTimeout(function(){if(u==false){m(true)}},r.swapDelay)};var b=function(){var t=this,n=e(window),i=false;t.trigger=function(){u=false;if(r.autoSwap==true){y()}};n.on("resize",function(){if(i!=false){clearTimeout(i)}u=true;i=setTimeout(t.trigger,300)})};if(n.length){var w=n.css("position");if(w!="absolute"||w!="relative"||w!="fixed"){n.css("position","relative")}n.css("overflow","hidden");if(r.fixedAspect!=false){n.css({height:0,paddingBottom:r.fixedAspect+"%"})}if(f==true){s.css({display:"block",position:"absolute",top:0,opacity:0,width:"100%",height:"100%"});s.eq(0).css({opacity:1,zIndex:r.baseIndex+1,position:"relative"})}else{s.css({display:"none",position:"absolute",top:0,width:"100%",height:"100%"});s.eq(0).css({position:"relative",display:"block"})}s.each(function(){e(this).attr("data-slide",e(this).index()+1)});if(r.breakout!=false){r.breakout.find("> *").each(function(){e(this).attr("data-breakout",e(this).index()+1)})}if(r.bullets!=false){for(var h=0;h<s.length;h++){r.bullets.append('<li><a href="#" data-target="'+(h+1)+'">&nbsp;</a></li>')}r.bullets.find("li:first-child a").addClass("active");p()}if(r.keyboard==true){d()}if(r.prevButton!=false||r.nextButton!=false){v()}if(r.autoSwap==true){y()}if(r.disableOnResize==true){b()}}}})(jQuery)